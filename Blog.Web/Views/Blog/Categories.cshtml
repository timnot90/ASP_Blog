@using Blog.Web
@using Blog.Web.Models.Blog
@model CategoryListModel
@{
    ViewBag.Title = "Categories";
}

<div class="container">
    <div class="row">
        <div class="col-lg-12">
            <h1 class="page-header">
                @ViewBag.Title
                <small>Blog Homepage</small>
            </h1>
            <ol class="breadcrumb">
                <li>
                    @Html.ActionLink("Home", "Index", "Home")
                </li>
                <li class="active">@ViewBag.Title</li>
            </ol>
        </div>
    </div>
    <div class="row">
        <table class="table table-hover table-striped table-bordered">
            <tr>
                @if (Roles.IsUserInRole(CustomRoles.Administrator))
                {
                    <th>Name</th>
                    <th>Creation Date</th>
                    <th>Created By</th>
                    <th></th>
                }
            </tr>
            @foreach (CategoryModel category in Model.Categories)
            {
                <tr>
                    <td>
                        @Html.ActionLink(category.Name + " (" + category.NumberOfPosts + ")", "Index", "Blog", new {categoryId = category.Id}, null)
                    </td>
                    @if (Roles.IsUserInRole(CustomRoles.Administrator))
                    {
                        <td>
                            @category.CreationDateString
                        </td>
                        <td>
                            @{ string username = category.Creator != null ? category.Creator.UserName : string.Empty; }
                            @{ string name = category.Creator != null ? category.Creator.Forename + " " + category.Creator.LastName : string.Empty; }

                            @*write "username (name)"*@
                            @username @{
                        if (!string.IsNullOrEmpty(name))
                        {
                            <span> (@name)</span>
                        }
                            }
                        </td>
                        <td>
                            <a href="@Url.Action("DeleteCategory", new {categoryId = category.Id})" class="btn btn-danger">
                                <i class="glyphicon glyphicon-trash"></i>
                                Delete
                            </a>
                        </td>
                    }
                </tr>
            }
        </table>
        @Html.Action("AddCategory", "Blog")
    </div>
</div>